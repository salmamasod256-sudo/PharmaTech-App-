
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>Pharma Tech App</title>
    
    <!-- 1. ุฑุจุท ููู ุงูุชุตููู (ุงูุฃููุงู ูุงูุดูู) -->
    <link rel="stylesheet" href="style.css">
    
    <!-- ุงูุฎุทูุท -->
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@700&display=swap" rel="stylesheet">
    
    <!-- ุงูููุชุจุงุช ุงูุฎุงุฑุฌูุฉ (ุงููุงููุฑุง ููุงุนุฏุฉ ุงูุจูุงูุงุช) -->
    <script src="https://unpkg.com/html5-qrcode"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
</head>
<body>

    <!-- ูุฐุง ุงูุฌุฒุก ุงููู ุฃูุช ูุณุฎุชู (ุดุงุดุงุช ุงูุชุทุจูู) -->
    <div id="loading-overlay">
        <div class="loader"></div>
        <p>ุฌุงุฑู ุงุณุชุดุงุฑุฉ ุงูุฐูุงุก ุงูุงุตุทูุงุนู... ๐ค</p>
    </div>

    <div class="scanner-overlay" id="scannerOverlay">
        <div class="scanner-content">
            <div id="qr-reader-content">
                <p style="color:white; margin-bottom:10px;"><strong>ุงููุงุณุญ ุงูุฐูู</strong></p>
            </div>
            <p style="margin: 15px 0; color: white;">ุงุฎุชุฑ ุงูุทุฑููุฉ:</p>
            <button class="scanner-btn" onclick="startQRScan()">๐ท ูุณุญ ุจุงุฑููุฏ (QR)</button>
            <button class="scanner-btn" onclick="triggerAIFile()">๐ง ุชุญููู ูุตูุฉ (AI)</button>
            <input type="file" id="aiInput" accept="image/*" style="display: none;" onchange="analyzePrescriptionAI(this)">
            <button class="scanner-btn" style="background: #8b4513; margin-top: 20px;" onclick="hideScanner()">ุฅุบูุงู โ</button>
        </div>
    </div>

    <div id="page-index">
        <div class="content">
            <h1>ูุฑุญุจูุง ุจู ูู <span>Pharma Tech</span></h1>
            <div class="buttons">
                <button onclick="changePage('form')">ุฏุฎูู ุฅูู ุงูุชุทุจูู</button>
                <button class="chat" onclick="changePage('chat')">ุฏุฑุฏุดุฉ ุนุงูุฉ (Live)</button>
            </div>
        </div>
    </div>

    <div id="page-chat">
        <div class="chat-header-full">
            <button onclick="changePage('index')">โฌ ุฎุฑูุฌ</button>
            <span>ููุชูู ุงูุตูุงุฏูุฉ</span>
            <div style="width:30px"></div>
        </div>
        <div class="chat-body-full" id="chatBody"></div>
        <div class="chat-footer-full">
            <button class="icon-btn" onclick="document.getElementById('chatImgInput').click()">๐ท</button>
            <input type="file" id="chatImgInput" accept="image/*" hidden>
            <input type="text" id="chatInput" placeholder="ุงูุชุจ ุฑุณุงูุฉ...">
            <button class="send-btn" onclick="sendMessage()">โค</button>
        </div>
    </div>

    <div id="page-form">
        <div class="form-top-nav">
            <h2>Pharma Tech</h2>
            <button onclick="changePage('index')">โ</button>
        </div>
        <div id="ai-result-box">
            <h3>๐ ูุชูุฌุฉ ุงูุชุญููู ุงูุฐูู:</h3>
            <div id="ai-content"></div>
            <button onclick="this.parentElement.style.display='none'" style="background:#555; color:white; border:none; padding:5px 10px; margin-top:10px; border-radius:5px;">ุฅุฎูุงุก</button>
        </div>
        
        <!-- ุชุนุฏูู ุจุณูุท ููุง ูุฅุถุงูุฉ ุงูุงูุชุฑุงุญุงุช -->
        <form onsubmit="calculateAndShow(); return false;" style="position: relative;">
            <label>ุงุณู ุงูุญุงูุฉ:</label>
            <input type="text" id="caseName" placeholder="ูุซูุงู: ูุฒูุฉ ุจุฑุฏ..." required>
            <div class="row">
                <div class="col">
                    <label>ุงูุนูุฑ:</label>
                    <input type="number" id="age" required>
                </div>
                <div class="col">
                    <label>ุงููุฒู (ูุบ):</label>
                    <input type="number" id="weight" required>
                </div>
            </div>
            <label>ุงุณู ุงูุฏูุงุก:</label>
            <div style="position: relative;">
                <input type="text" id="drugName" placeholder="ุงูุชุจ ุงูุงุณู ุฃู ุงุณุชุฎุฏู ุงููุงููุฑุง" oninput="searchDrug(this.value)" autocomplete="off" required>
                <div id="suggestions-box"></div>
            </div>
            
            <!-- ุญูู ูุฎูู ูุชุฎุฒูู ุงูุฏูุงุก ุงููุฎุชุงุฑ -->
            <input type="hidden" id="selectedDrugId">

            <label>ุงูุดูู ุงูุตูุฏูุงูู:</label>
            <select id="form">
                <option value="" disabled selected>ุงุฎุชุฑ ุดูู ุงูุฏูุงุก (ุงุฎุชูุงุฑู)</option>
                <option value="ูุฑุต (Tablet)">ูุฑุต (Tablet)</option>
                <option value="ุดุฑุงุจ (Syrup)">ุดุฑุงุจ (Syrup)</option>
                <option value="ุญูู (Injection)">ุญูู (Injection)</option>
            </select>
            <button type="submit" class="submit">ุญุณุงุจ ุงูุฌุฑุนุฉ</button>
        </form>
        <div class="camera-btn" onclick="showScanner()">
            <svg class="camera-icon" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm0-14c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm0 6c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z"/></svg>
        </div>
    </div>

    <div id="page-result">
        <div class="result-card">
            <div class="welcome-header">ุงููุชูุฌุฉ ุงูููุงุฆูุฉ</div>
            <div class="drug-name-display" id="resDrugName"></div>
            <ul id="result-list"></ul>
        </div>
        <div class="action-buttons">
            <button class="action-btn" onclick="changePage('index')">ุงูุฑุฆูุณูุฉ</button>
            <button class="action-btn" onclick="changePage('form')">ุฅุนุงุฏุฉ</button>
        </div>
    </div>

    <!-- 2. ุฑุจุท ูููุงุช ุงูุจุฑูุฌุฉ ููุงุนุฏุฉ ุงูุจูุงูุงุช (ููู ุฌุฏุงู) -->
    <script src="drugs.js"></script>
    <script src="script.js"></script>

</body>
</html>
